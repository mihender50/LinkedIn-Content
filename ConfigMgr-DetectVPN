cmd.exe /c powershell.exe -executionpolicy bypass -command "Try{$ADSite = nltest /dsgetsite | out-string -ErrorAction SilentlyContinue; Write-debug 'Able to Query AD Site'} Catch {Write-debug 'Unable to Query AD Site'}";$Adsiteformat = $ADSite.Replace("'The command completed successfully'", "''"); $Adsiteformat = $Adsiteformat.TrimEnd(); "if (($adsiteformat -like '*VPN*' -or $adsiteformat -like '*Remote*') -or (get-netipconfiguration | select-object -Property ipv4address, interfacedescription | where-object interfacedescription -like *Cisco* | where-object ipv4address -ne "$null")){$Remote='True'; Write-Output "VPN or Remote Usage Detection Equals $Remote"}Else {$Remote='False'; Write-Output "VPN or Remote Usage Detection Equals $Remote"}" ; $tsenv = new-object -ComObject Microsoft.SMS.TSEnvironment; $tsenv.value("'TSDetectRemoteConnection'") = $Remote
